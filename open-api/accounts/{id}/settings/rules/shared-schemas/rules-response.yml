type: object
properties:
  data:
    type: object
    properties:
      type:
        type: string
        example: accounts
      id:
        type: string
        description: Conformity account ID.
        example: H19NxMi5-
      attributes:
        type: object
        properties:
          settings:
            type: object
            properties:
              rules:
                type: array
                items:
                  type: object
                  properties:
                    ruleExists:
                      type: boolean
                      example: true
                      description: "????"
                    riskLevel:
                      type: string
                      description: Risk level of the Conformity rule.
                      enum: [LOW, MEDIUM, HIGH, VERY_HIGH, EXTREME]
                    id:
                      type: string
                      description: Rule ID.
                      example: RDS-018
                    extraSettings:
                      $ref: "../shared-schemas/extra-settings.yml"
                    enabled:
                      type: boolean
                      description: false if the rule is manually configured to be disabled for the account.
                      example: false
                    provider:
                      type: string
                      enum: [aws, azure]
                      description: Name of the cloud provider
                      example: aws
              available-runs:
                type: integer
                description: "????"
                example: 5
      relationships:
        type: object
        properties:
          organisation:
            $ref: "../../../../../shared-schemas/organisation-short.yml"
  meta:
    type: object
    properties:
      notes:
        type: array
        description: List of notes for the rule.
        items:
          type: object
          properties:
            createdBy:
              type: string
              description: ID of the user who has created the note.
              example: "SYmS0YcL-"
            createdDate:
              type: integer
              description: A date-time in Unix Epoch timestamp format (in milliseconds) which indicates when the note has been created.
              example: 1511456432526
            note:
              type: string
              description: Note added to the rule.
              example: hello world
example:
  data:
    type: accounts
    id: AgA12vIwb
    attributes:
      settings:
        rules:
          - riskLevel: VERY_HIGH
            id: CT-001
            extraSettings:
            provider: aws
            enabled: true
          - riskLevel: MEDIUM
            id: RTM-005
            extraSettings:
              - name: authorisedCountries
                countries: true
                type: countries
                value:
                values:
                  - value: CA
                    label: Canada
                  - value: US
                    label: United States
            provider: aws
            enabled: false
          - ruleExists: false
            riskLevel: MEDIUM
            id: RTM-008
            extraSettings:
              - name: authorisedRegions
                regions: true
                type: regions
                value:
                values:
                  - eu-west-1
                  - eu-west-2
            provider: aws
            enabled: false
          - ruleExists: false
            riskLevel: MEDIUM
            id: RDS-018
            exceptions:
              resources:
                - i-erw82heiu8
              tags:
                - mysql-backups
            extraSettings:
              - name: threshold
                value: 90
                values: []
                type: []
            provider: aws
            enabled: false
        access: {}
      available-runs: 5
      access:
    relationships:
      organisation:
        data:
          type: organisations
          id: B1nHYYpwx
